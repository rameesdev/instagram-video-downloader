<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Instagram Video Downloader - Free & Fast | Download Reels</title>
    <meta name="description" content="Download Instagram videos for free. Fast, secure Instagram video downloader tool. Save Instagram reels, videos, and stories instantly. No registration required.">
    <meta name="keywords" content="instagram video downloader, download instagram videos, instagram downloader, save instagram videos, instagram video saver, download reels, instagram stories downloader, free instagram downloader">
    <meta name="robots" content="index, follow">
    <meta name="author" content="InstaSave">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Free Instagram Video Downloader - Download Instagram Videos Online">
    <meta property="og:description" content="Download Instagram videos for free. Fast, secure Instagram video downloader tool. Save Instagram reels and videos instantly.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://instasave.com">
    <meta property="og:image" content="https://instasave.com/og-image.jpg">
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Instagram Video Downloader">
    <meta name="twitter:description" content="Download Instagram videos for free. Fast, secure Instagram video downloader tool.">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://instasave.com">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"></noscript>
    
    <!-- Inline Critical CSS -->
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif;background:#f8fafc;line-height:1.6}
        .container{max-width:800px;margin:0 auto;padding:20px;min-height:100vh;display:flex;flex-direction:column;justify-content:center}
        .card{background:#fff;padding:40px;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.1);text-align:center}
        .title{font-size:2.5rem;font-weight:700;color:#1e293b;margin-bottom:8px}
        .subtitle{color:#64748b;margin-bottom:32px;font-size:1.1rem}
        .form{display:flex;gap:12px;margin-bottom:24px;flex-wrap:wrap}
        .input{flex:1;padding:14px;border:2px solid #e2e8f0;border-radius:10px;font-size:16px;min-width:300px;transition:border-color 0.2s}
        .input:focus{outline:none;border-color:#8b5cf6}
        .btn{background:#8b5cf6;color:#fff;padding:14px 24px;border:none;border-radius:10px;font-weight:600;cursor:pointer;transition:background 0.2s;font-size:16px}
        .btn:hover{background:#7c3aed}
        .btn:disabled{opacity:0.5;cursor:not-allowed}
        .status{min-height:40px;margin-top:16px}
        .text-green{color:#059669}
        .text-red{color:#dc2626}
        .text-gray{color:#6b7280}
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:40px;text-align:left}
        .feature{padding:20px;background:#f1f5f9;border-radius:12px}
        .feature h3{color:#1e293b;margin-bottom:8px;font-weight:600}
        .feature p{color:#64748b;font-size:14px}
        .faq{margin-top:40px;text-align:left}
        .faq h2{color:#1e293b;margin-bottom:20px;font-size:1.5rem}
        .faq-item{margin-bottom:16px;padding:16px;background:#f8fafc;border-radius:8px}
        .faq-item h3{color:#374151;margin-bottom:8px;font-size:1rem}
        .faq-item p{color:#6b7280;font-size:14px}
        @media (max-width:768px){
            .title{font-size:2rem}
            .form{flex-direction:column}
            .input{min-width:100%}
            .card{padding:24px}
        }
    </style>
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Instagram Video Downloader",
        "description": "Free online tool to download Instagram videos, reels, and stories",
        "url": "https://instasave.com",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Download Instagram Videos",
            "Download Instagram Reels", 
            "Download Instagram Stories",
            "High Quality Downloads",
            "No Registration Required"
        ]
    }
    </script>
</head>
<body>
    <div class="container">
        <main class="card">
            <header>
                <h1 class="title">Instagram Video Downloader</h1>
                <p class="subtitle">Download Instagram videos, reels, and stories for free. Fast, secure, and easy to use.</p>
            </header>

            <form id="downloadForm" class="form" role="form" aria-label="Instagram video download form">
                <input 
                    type="url" 
                    id="instaUrl" 
                    name="url" 
                    placeholder="Paste Instagram video URL here..." 
                    required
                    class="input"
                    aria-label="Instagram video URL"
                    autocomplete="url"
                >
                <button type="submit" id="downloadButton" class="btn" aria-label="Download Instagram video">
                    Download Video
                </button>
            </form>

            <div id="statusMessage" class="status" role="status" aria-live="polite"></div>

            <section class="features">
                <div class="feature">
                    <h3>üöÄ Fast Downloads</h3>
                    <p>Download Instagram videos in seconds with our optimized servers</p>
                </div>
                <div class="feature">
                    <h3>üîí Safe & Secure</h3>
                    <p>No malware, no registration required. Your privacy is protected</p>
                </div>
                <div class="feature">
                    <h3>üì± All Devices</h3>
                    <p>Works on mobile, tablet, and desktop. Download anywhere, anytime</p>
                </div>
                <div class="feature">
                    <h3>üé¨ High Quality</h3>
                    <p>Download videos in original quality, including HD and Full HD</p>
                </div>
            </section>

            <section class="faq">
                <h2>Frequently Asked Questions</h2>
                <div class="faq-item">
                    <h3>How to download Instagram videos?</h3>
                    <p>Simply paste the Instagram video URL into the input field above and click "Download Video". The video will be processed and available for download.</p>
                </div>
                <div class="faq-item">
                    <h3>Is it free to download Instagram videos?</h3>
                    <p>Yes! Our Instagram video downloader is completely free to use. No hidden fees or registration required.</p>
                </div>
                <div class="faq-item">
                    <h3>What video formats are supported?</h3>
                    <p>We support MP4 format downloads, which is compatible with all devices and media players.</p>
                </div>
                <div class="faq-item">
                    <h3>Can I download Instagram Reels and Stories?</h3>
                    <p>Yes! Our tool supports downloading Instagram videos, Reels, and Stories content in high quality.</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Optimized JavaScript -->
    <script>
        const form = document.getElementById('downloadForm');
        const statusDiv = document.getElementById('statusMessage');
        const downloadButton = document.getElementById('downloadButton');

        // Debounce function to reduce unnecessary API calls
        function debounce(func, delay) {
            let timeoutId;
            return function (...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => func.apply(this, args), delay);
            };
        }

        // Function to download video from blob URL
        async function downloadVideoFromUrl(videoUrl) {
            try {
                statusDiv.innerHTML = '<p class="text-gray">Starting download...</p>';
                
                // Fetch the video content
                const videoResponse = await fetch(videoUrl);
                if (!videoResponse.ok) {
                    throw new Error(`Failed to fetch video: ${videoResponse.status}`);
                }
                
                // Create blob from response
                const videoBlob = await videoResponse.blob();
                
                // Create download link and trigger download
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(videoBlob);
                downloadLink.download = `instagram_video_${Date.now()}.mp4`;
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // Clean up the blob URL after some time
                setTimeout(() => URL.revokeObjectURL(downloadLink.href), 10000);
                
                statusDiv.innerHTML = '<p class="text-green">‚úÖ Download complete!</p>';
            } catch (downloadError) {
                console.error('Download error:', downloadError);
                statusDiv.innerHTML = '<p class="text-red">‚ùå Failed to start download. Please try again.</p>';
            }
        }

        // Optimized form submission with error handling
        const handleSubmit = debounce(async function(e) {
            e.preventDefault();

            const url = document.getElementById('instaUrl').value.trim();
            
            // Basic URL validation to reduce server load
            if (!url || !url.includes('instagram.com')) {
                statusDiv.innerHTML = '<p class="text-red">Please enter a valid Instagram URL</p>';
                return;
            }

            statusDiv.innerHTML = '<p class="text-gray">Processing your request...</p>';
            downloadButton.disabled = true;
            downloadButton.textContent = 'Processing...';

            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30s timeout

                const response = await fetch('/download', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url }),
                    signal: controller.signal
                });

                clearTimeout(timeoutId);
                const data = await response.json();

                if (response.ok && data.success) {
                    statusDiv.innerHTML = `
                        <p class="text-green">‚úÖ Video ready for download!</p>
                        <button id="finalDownloadButton" class="btn" style="margin-top:12px">
                           Download Now
                        </button>
                    `;
                    
                    document.getElementById('finalDownloadButton').onclick = () => {
                        downloadVideoFromUrl(data.url);
                    };
                } else {
                    statusDiv.innerHTML = `<p class="text-red">‚ùå ${data.error || 'Failed to process video. Please check the URL and try again.'}</p>`;
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    statusDiv.innerHTML = '<p class="text-red">‚ùå Request timeout. Please try again.</p>';
                } else {
                    statusDiv.innerHTML = '<p class="text-red">‚ùå Connection error. Please check your internet and try again.</p>';
                }
            } finally {
                downloadButton.disabled = false;
                downloadButton.textContent = 'Download Video';
            }
        }, 300); // 300ms debounce

        form.addEventListener('submit', handleSubmit);

        // Preload critical resources
        if ('requestIdleCallback' in window) {
            requestIdleCallback(() => {
                // Preload potential next resources when browser is idle
                const link = document.createElement('link');
                link.rel = 'dns-prefetch';
                link.href = '//instagram.com';
                document.head.appendChild(link);
            });
        }
    </script>

    <!-- Analytics placeholder - replace with your tracking code -->
    <!-- Google Analytics or other tracking scripts would go here -->
</body>
</html>